# Efficient Named Entity Recognition for Cyber Threat Intelligence

åŸºäº XLNet-CRF æ¶æ„çš„ç½‘ç»œå¨èƒæƒ…æŠ¥å‘½åå®ä½“è¯†åˆ«ç³»ç»Ÿï¼Œæ”¯æŒä¸‰ä¸ªä¸“ä¸šé¢†åŸŸçš„å®ä½“è¯†åˆ«ä»»åŠ¡ã€‚

## ğŸ” é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªé«˜æ•ˆçš„å‘½åå®ä½“è¯†åˆ«ï¼ˆNERï¼‰ç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºç½‘ç»œå¨èƒæƒ…æŠ¥ï¼ˆCyber Threat Intelligenceï¼‰åˆ†æã€‚  
ç³»ç»Ÿé‡‡ç”¨ **XLNet + CRF** æ¶æ„ï¼Œé€‚é…ä»¥ä¸‹ä¸‰ä¸ªä¸“ä¸šé¢†åŸŸï¼š

- **CTI-Reports **

- è¯†åˆ«å“ˆå¸Œå€¼ã€IP åœ°å€ã€æ¶æ„è½¯ä»¶ã€URL ç­‰ç½‘ç»œå¨èƒå®ä½“  

  > ğŸ“„ `xlnet_crf_cti.py`

- **DNRTI  **
  è¯†åˆ«é»‘å®¢ç»„ç»‡ã€æ”»å‡»æ‰‹æ®µã€å·¥å…·ã€æ—¶é—´ã€åœ°ç‚¹ç­‰å¨èƒæƒ…æŠ¥å…ƒç´   

  > ğŸ“„`xlnet_crf_dnrti.py`

- **MalwareTextDB**  
  è¯†åˆ«æ¶æ„è½¯ä»¶ç›¸å…³çš„å®ä½“ã€è¡Œä¸ºå’Œä¿®é¥°è¯­  

  > ğŸ“„ `xlnet_crf_malware.py`

---

## ğŸ§  æ¨¡å‹æ¶æ„

- **XLNet-CRF æ··åˆæ¶æ„**ï¼šç»“åˆ XLNet çš„åŒå‘å»ºæ¨¡èƒ½åŠ›ä¸ CRF çš„æ ‡ç­¾ä¾èµ–ä¼˜åŠ¿  

- **ç»Ÿä¸€è®­ç»ƒæ¡†æ¶**ï¼šä¸‰ç§ä»»åŠ¡ä½¿ç”¨ç›¸åŒæ¶æ„ï¼Œæ ‡ç­¾ä½“ç³»ä¸åŒ  

- **æ”¯æŒé•¿åºåˆ—å¤„ç†**ï¼šæœ€å¤§è¾“å…¥é•¿åº¦ä¸º 256 tokens  

  > ğŸ“„ `xlnet_crf_cti.py:17`

---

## âš™ï¸ è®­ç»ƒé…ç½®

- **Batch Size**ï¼š32  

  > ğŸ“„ `xlnet_crf_cti.py:18`

- **å­¦ä¹ ç‡è®¾ç½®**ï¼š

  - XLNet éƒ¨åˆ†ï¼š`5e-5`
  - CRF å±‚ï¼š`8e-5`

- **è®­ç»ƒè½®æ•°**ï¼š

  - CTI å’Œ Malwareï¼š80è½®
  - DNRTIï¼š90è½®  

  > ğŸ“„ `xlnet_crf_cti.py:20`

---



## ğŸ“ é¡¹ç›®ç»“æ„

```text
â”œâ”€â”€ xlnet_crf_cti.py           # CTI è®­ç»ƒè„šæœ¬
â”œâ”€â”€ xlnet_crf_dnrti.py         # DNRTI è®­ç»ƒè„šæœ¬
â”œâ”€â”€ xlnet_crf_malware.py       # Malware è®­ç»ƒè„šæœ¬
â”œâ”€â”€ predict.py                 # é¢„æµ‹ä¸æ¨ç†è„šæœ¬
â”œâ”€â”€ print_metric_cti.py        # CTI è¯„ä¼°å›¾è¡¨ç”Ÿæˆ
â”œâ”€â”€ print_metric_dnrti.py      # DNRTI è¯„ä¼°å›¾è¡¨ç”Ÿæˆ
â”œâ”€â”€ print_metric_malware.py    # Malware è¯„ä¼°å›¾è¡¨ç”Ÿæˆ
â”œâ”€â”€ datasets/                  # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ CTI-reports/
â”‚   â”œâ”€â”€ DNRTI/
â”‚   â””â”€â”€ MalwareTextDB/
â””â”€â”€ outputs/
    â”œâ”€â”€ è®­ç»ƒæ—¥å¿—æ–‡ä»¶
    â”œâ”€â”€ æ¨¡å‹æ£€æŸ¥ç‚¹
    â””â”€â”€ æ€§èƒ½å›¾è¡¨

```
---

## ğŸ“¦ å®‰è£…ä¾èµ–

```bash
pip install torch transformers numpy pandas matplotlib seaborn
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1ï¸âƒ£ æ¨¡å‹è®­ç»ƒ

è®­ç»ƒ CTI æ¨¡å‹ï¼š

```
python xlnet_crf_cti.py
```

è®­ç»ƒ DNRTI æ¨¡å‹ï¼š

```
python xlnet_crf_dnrti.py
```

è®­ç»ƒ Malware æ¨¡å‹ï¼š

```
python xlnet_crf_malware.py
```

### 2ï¸âƒ£ æ¨¡å‹é¢„æµ‹

```
python predict.py
```

> ğŸ“„ é¢„æµ‹é€»è¾‘è§ï¼š`predict.py:79-150`

### 3ï¸âƒ£ æ€§èƒ½è¯„ä¼°ä¸å¯è§†åŒ–

```
python print_metric_cti.py       # CTI æ€§èƒ½å›¾è¡¨  
python print_metric_dnrti.py     # DNRTI æ€§èƒ½å›¾è¡¨  
python print_metric_malware.py   # Malware æ€§èƒ½å›¾è¡¨
```

## ğŸ“š æ•°æ®æ ¼å¼

ç³»ç»Ÿä½¿ç”¨ **BIO æ ‡æ³¨æ ¼å¼**ã€‚æ¯ä¸ªæ•°æ®é›†åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼ˆTSV æ ¼å¼ï¼‰ï¼š

```
train.txt   # è®­ç»ƒé›†
valid.txt   # éªŒè¯é›†
test.txt    # æµ‹è¯•é›†
```

> ğŸ“„ æ•°æ®è¯»å–ä»£ç å‚è€ƒï¼š`xlnet_crf_cti.py:29-43`

------

## ğŸ“¤ è¾“å‡ºæ–‡ä»¶

è®­ç»ƒå®Œæˆåå°†ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

- `.pt`ï¼šæ¨¡å‹æ£€æŸ¥ç‚¹
- `.txt`ï¼šè®­ç»ƒæ—¥å¿—
- `.png`ï¼šæ€§èƒ½å›¾è¡¨

> ğŸ“„ è¾“å‡ºé€»è¾‘è§ï¼š`xlnet_crf_cti.py:22`

------

## ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡

ç³»ç»Ÿæä¾›ä»¥ä¸‹ NER å¸¸ç”¨è¯„ä¼°æŒ‡æ ‡ï¼š

- **Accuracy**ï¼ˆå‡†ç¡®ç‡ï¼‰
- **Precision**ï¼ˆç²¾ç¡®ç‡ï¼‰
- **Recall**ï¼ˆå¬å›ç‡ï¼‰
- **F1-Score**ï¼ˆF1 åˆ†æ•°ï¼‰

> ğŸ“„ è¯„ä¼°ä»£ç ï¼š`xlnet_crf_cti.py:642-668`
